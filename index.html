<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="description" content="Browser-based drum machine and loop pedal for children ages 8-12">
  <meta name="theme-color" content="#1a1a1a">
  <title>Drum Machine & Loop Pedal</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body data-theme="dark">
  <!-- Tutorial Overlay -->
  <div id="tutorial" class="tutorial hidden" role="dialog" aria-labelledby="tutorial-title" aria-modal="true">
    <div class="tutorial__content">
      <h2 id="tutorial-title" class="tutorial__title">Welcome!</h2>
      <p class="tutorial__text">Let's learn how to make music!</p>
      <div class="tutorial__navigation">
        <button class="btn btn--secondary tutorial__skip" aria-label="Skip tutorial">Skip</button>
        <button class="btn btn--primary tutorial__next" aria-label="Next step">Next</button>
      </div>
    </div>
  </div>

  <!-- Help Overlay -->
  <div id="help" class="help hidden" role="dialog" aria-labelledby="help-title" aria-modal="true">
    <div class="help__content">
      <button class="help__close" aria-label="Close help">√ó</button>
      <h2 id="help-title" class="help__title">Help & Shortcuts</h2>
      <div class="help__sections">
        <section class="help__section">
          <h3>Drum Sequencer</h3>
          <p>Click on the grid to add or remove drum beats. Press play to hear your rhythm!</p>
        </section>
        <section class="help__section">
          <h3>Loop Pedal</h3>
          <p>Record your voice or instruments through the microphone. Layer up to 6 loops!</p>
        </section>
        <section class="help__section">
          <h3>Keyboard Shortcuts</h3>
          <ul>
            <li><kbd>Space</kbd> - Play/Pause</li>
            <li><kbd>Esc</kbd> - Stop</li>
            <li><kbd>+/-</kbd> - Tempo up/down</li>
            <li><kbd>1-9</kbd> - Load presets</li>
            <li><kbd>S</kbd> - Save session</li>
            <li><kbd>H</kbd> - Toggle help</li>
            <li><kbd>T</kbd> - Change theme</li>
          </ul>
        </section>
      </div>
    </div>
  </div>

  <!-- Main Application Container -->
  <div id="app" class="app">
    <!-- Header / Toolbar -->
    <header class="header">
      <div class="header__left">
        <h1 class="header__title">Drum Machine & Loop Pedal</h1>
      </div>
      <div class="header__right">
        <button id="themeBtn" class="btn btn--icon" aria-label="Change theme" title="Change theme">
          <span class="icon">üé®</span>
        </button>
        <button id="helpBtn" class="btn btn--icon" aria-label="Show help" title="Help">
          <span class="icon">?</span>
        </button>
        <button id="saveBtn" class="btn btn--secondary" aria-label="Save session" title="Save your work">
          <span class="icon">üíæ</span> Save
        </button>
        <button id="loadBtn" class="btn btn--secondary" aria-label="Load session" title="Load saved work">
          <span class="icon">üìÅ</span> Load
        </button>
      </div>
    </header>

    <!-- Main Content Area -->
    <main class="main">
      <!-- Left Panel: Preset Patterns -->
      <aside class="presets" role="complementary" aria-label="Preset patterns">
        <h2 class="presets__title">Presets</h2>
        <div class="presets__list" id="presetList">
          <!-- Preset buttons will be generated by JavaScript -->
        </div>
      </aside>

      <!-- Center Panel: Drum Sequencer -->
      <section class="sequencer" role="region" aria-label="Drum sequencer">
        <div class="sequencer__header">
          <h2 class="sequencer__title">Drum Sequencer</h2>
          <div class="sequencer__controls">
            <label class="control">
              <span class="control__label">BPM</span>
              <input
                type="number"
                id="tempoInput"
                class="control__input"
                min="60"
                max="180"
                value="120"
                aria-label="Beats per minute"
              >
            </label>
          </div>
        </div>

        <!-- Sequencer Grid -->
        <div class="sequencer__grid-container">
          <div class="sequencer__track-names" id="trackNames">
            <!-- Track names will be generated by JavaScript -->
          </div>
          <div class="sequencer__grid-wrapper">
            <canvas
              id="sequencerCanvas"
              class="sequencer__canvas"
              role="img"
              aria-label="16-step drum sequencer grid"
            ></canvas>
          </div>
        </div>

        <!-- Waveform Visualization -->
        <div class="sequencer__visualization">
          <canvas
            id="waveformCanvas"
            class="visualization__canvas"
            aria-label="Audio waveform visualization"
          ></canvas>
        </div>
      </section>

      <!-- Right Panel: Loop Pedal -->
      <aside class="loop-pedal" role="complementary" aria-label="Loop pedal">
        <h2 class="loop-pedal__title">Loop Pedal</h2>

        <!-- Microphone Status -->
        <div class="loop-pedal__mic-status">
          <button id="micBtn" class="btn btn--primary" aria-label="Enable microphone">
            <span class="icon">üé§</span> Enable Mic
          </button>
          <div id="micLevel" class="mic-level hidden">
            <div class="mic-level__bar"></div>
          </div>
        </div>

        <!-- Loop Tracks -->
        <div class="loop-pedal__tracks" id="loopTracks">
          <!-- Loop track controls will be generated by JavaScript -->
        </div>

        <!-- Master Controls -->
        <div class="loop-pedal__master">
          <label class="control control--vertical">
            <span class="control__label">Master Volume</span>
            <input
              type="range"
              id="masterVolume"
              class="control__slider"
              min="0"
              max="100"
              value="80"
              aria-label="Master volume"
            >
            <span class="control__value" id="masterVolumeValue">80%</span>
          </label>
        </div>
      </aside>
    </main>

    <!-- Footer / Transport Controls -->
    <footer class="transport" role="region" aria-label="Transport controls">
      <div class="transport__controls">
        <button id="rewindBtn" class="btn btn--transport" aria-label="Rewind to start" title="Rewind">
          <span class="icon">‚èÆ</span>
        </button>
        <button id="playPauseBtn" class="btn btn--transport btn--play" aria-label="Play" title="Play/Pause (Space)">
          <span class="icon icon--play">‚ñ∂</span>
          <span class="icon icon--pause hidden">‚ùö‚ùö</span>
        </button>
        <button id="stopBtn" class="btn btn--transport" aria-label="Stop" title="Stop (Esc)">
          <span class="icon">‚ñ†</span>
        </button>
        <button id="forwardBtn" class="btn btn--transport" aria-label="Fast forward" title="Fast forward">
          <span class="icon">‚è≠</span>
        </button>
      </div>

      <div class="transport__info">
        <div class="transport__tempo">
          <span class="transport__label">Tempo:</span>
          <span class="transport__value" id="tempoDisplay">120 BPM</span>
        </div>
        <div class="transport__position">
          <span class="transport__label">Beat:</span>
          <span class="transport__value" id="beatDisplay">1.1</span>
        </div>
      </div>
    </footer>
  </div>

  <!-- Tooltip -->
  <div id="tooltip" class="tooltip hidden" role="tooltip"></div>

  <!-- Scripts -->
  <script src="js/audio-engine.js"></script>
  <script src="js/presets.js"></script>
  <script src="js/sequencer.js"></script>
  <script src="js/loop-pedal.js"></script>
  <script src="js/storage.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/main.js"></script>
</body>
</html>
